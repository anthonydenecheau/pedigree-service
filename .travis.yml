language: java
cache:
  directories:
  - "$HOME/.m2"
dist: trusty
jdk:
- oraclejdk8
sudo: required
services:
- docker
notifications:
  slack:
    secure: V0ktPeM+cto4/USxHkIBWPyyZ/ni5v7yPwGFVbalPUvkPmYRgFq5T0p8E/Tp9iW1JXVJ7x7vigytwrxjgChgcI6pU7ba7ud6qpbV1XiPnR7KTDi9UJ6/R4QyZkAyTewprGiPCMNgFm2fpweA/+emII+QfKvLvk1EQ5mnwJa2urbHZpxZUXoT9F1NtGoHxXCwGHS3XzGJeB5wSHj9/N3JhQ1gljgPGVJYqJ64pFidTyNH1I0hCekmODUwXiq+EGtPDd3qitnW+cAyjkTo38t4VMiGfYnnJeHE0DUPw1T5iKxUlJbuMNqbznnbNZ4UA5Yl1V7JRvqBX6IHG/Bz2Oqz0BdeTRujhJsHvTYxrwRjujA3lboe/rCJw+o7I18ObO2U3h7VGoyk93S4b5mgKg7xYxnmiW2LzCDq+XTo2/+SaL+IQD74A4YwQit0Ng4xKCwUveT2hIHkzoTox89plHNtU0f30BAbAz4WsWlvn/WNcuXwjS8It2mmUb0P5DgQnBX+FsCfQDfUl7dDulFZc3yrYsPnfJGkQgLYJ2YvgiUkZSMwT9gNj5RlUucuEMh/ZnL/MQqo3jflSTu0Llro0znXYcrqqd6pT2RjQ4Vx7UTktNRRBnSAERwPPA6E8LDdajLrdYHDBnffo7cCG8I6VlNEr5IM+fwhlJ/jgr7Y4DFN464=
  email:
  - anthony.denecheau@gmail.com
  on_success: always
  on_failure: always
env:
  global:
  - secure: SXirkFIXpQY2YLoseUVvODYPYZKHbvSd3o0gzGsx0Xs8thjD+AfHFqxwoneQNqg6qrwmz4m8sh6AbS9C6pDDWZ6wMELWfUYE9fHqQBdLq1U8myB0isoAyf+j3bmKtEEEhm8OAluvOz9YFFoRVg+Z1+c8MUVfmW5BECyB3xWGkLT1xoteQ4Gjbie0M/an/24GmHieQmGpEWUCgYOOnN6CBDLW8TeXclOxkTzVDLm3dT96YPBftJVEg5V4fhrOYHne9Pgl5iGHCmPL0TZLU0mWcTgDdyJa6TrtT9an2wKXL8Kyyh/dWg2TSJL7SjHbWZK1fpDAxMqW5YGUUWLSbI+KWhS8W7czALIL0YK3K710cEzdhQqTNBGPl26/WMjxOVQQDJlw6oYkLC7YLmX4cWmuXhZTE2P37FHYJy3tgvnOcgJ8ZQaZFK7LhpSoC4NwiYh05oeOUp/kfc6VkH+cfj1xOI0vifCfJNHZe0Ox+Ix8k5wKKGlGeIZEMC64pk0n4mk4Z1s1+3UfJEBc60IbDu5gzmYKMyq4dhBf2GU8JUyUSE1RCnj+F5Yo1ENiZxy5jAmY99I3hg1I5FroDV/GzBSx8/aBIdUCCm8tXlo6cDgDkbr3+mFVzqkxuyFgYlqkUvKjtsxJzLXGQ1I+i+tDtJRiZlPm3Z8UNXoCRST5xvO6T0w=
  - secure: VrvLfcJg3FAzZmbUIQAZem6LXSmoLlmGMf2tj233Q3Kem8PLY+a7WB+uTz7hLunGIDlPAOOsL+Dijg7j1VvR055MUy9tO/HWSqEfj8cgIugzWI95UjVBfyis2SQkY4I5pRvgBmoiTCh6IyJJU8nx+dU5jaWZdktGYbqaDPiSSBcfVyANu3SXeFxQRGpurPzdYkS9XkqM8rwXP1g7I+KTJp6lKvfbtmA0w+5SQ0dVCm8L0mmidvBYXTEoPOLs5+nj6WqIYrnBLlKwx45iAlMgVIqhCLw83SSCB48FlDrrhYd6KYADVu9NnFjgc/ANIvsUptsqnzARUNR1WQCAICjo0LATehEo3VIdlswGetClG2qWOWeWX0hXccMTremRr9PJ7u1+Ev8xL10t5nKGH4mHXLQaLbnSLLp5kQlK58CGgHWwhtTcmU34DurqybBwr/5EFQNl/sFk4XSqfU+e5OX5G7r5h320F9NW4E7hqjpQjMyPanehAVk5kOa3S8UWAEKXVSBpO0g6Vzv/G3bgqoKjFdZ+462NtPFrwZMUEUEMo4ItamIIvTH27nCRAcA5fMuV41J0Q+Eonj/iTnROLI7g9TZ4974cn6t5GLd2kG5pPNfVMEZvLNnKM0SjT4Z/aYvtBT4TlFCnjx4nX1pEH7kk+UXC0srnQ973jK5mM07hnBs=
before_install:
- ruby -v
- gem install travis -v 1.8.9 --no-document
- export BUILD_NAME=scc-pedigree-service-$TRAVIS_BRANCH-$(date -u "+%Y%m%d%H%M%S")-$TRAVIS_BUILD_NUMBER
jobs:
  include:
  - stage: build and publish to Docker Hub
    env: GCP_ENV=re7
    script:
    - sh scripts/travis/tag_build.sh
    - sh scripts/travis/build_services.sh
    - sh scripts/travis/deploy_to_docker_hub.sh
stages:
- name: build and publish to Docker Hub
  if: branch = master
